<!DOCTYPE html>
<html lang="lv">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ievietot sludinājumu</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #E0D3BC;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      margin: 0;
      padding: 40px 0;
      color: #474737;
    }
    .container {
      background-color: #F0EDE1;
      padding: 40px 50px;
      border-radius: 15px;
      max-width: 800px;
      width: 90%;
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.12);
      text-align: left;
    }
    h1, h2 {
      text-align: center;
      color: #474737;
      font-weight: 700;
    }
    h1 {
      font-size: 2.6rem;
      margin-bottom: 25px;
    }
    h2 {
      font-size: 1.5rem;
      margin-top: 30px;
      margin-bottom: 20px;
      border-bottom: 2px solid #CBD7B3;
      padding-bottom: 10px;
    }
    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      font-size: 1.1rem;
    }
    input[type="text"],
    input[type="number"],
    select,
    textarea {
      width: 100%;
      padding: 12px 14px;
      margin-bottom: 20px;
      border: 2px solid #CBD7B3;
      border-radius: 8px;
      font-size: 1.1rem;
      resize: vertical;
      box-sizing: border-box;
      background-color: white;
    }
    .year-inputs {
      display: flex;
      gap: 20px;
    }
    .year-inputs > div {
        flex: 1;
    }
    textarea {
      min-height: 100px;
    }
    input[type="submit"] {
      background-color: #474737;
      color: white;
      font-weight: 700;
      border: none;
      padding: 14px 25px;
      border-radius: 10px;
      font-size: 1.2rem;
      cursor: pointer;
      transition: background-color 0.3s ease;
      width: 100%;
      margin-top: 30px;
    }
    input[type="submit"]:hover {
      background-color: #A7AE92;
      color: #474737;
    }
    /* Svarīgi: Visas filtru grupas sākotnēji paslēptas */
    .filter-group {
        display: none;
    }
    .extras-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 10px;
        margin-top: 10px;
    }
    .extra-item {
        display: flex;
        align-items: center;
        background-color: #e9e6d9;
        padding: 5px 10px;
        border-radius: 6px;
    }
    .extra-item input[type="checkbox"] {
        width: auto;
        margin-right: 10px;
    }
    .extra-item label {
        margin-bottom: 0;
        font-weight: 500;
        font-size: 0.95rem;
    }

    /* Media queries */
    @media (max-width: 600px) {
      .container {
        padding: 20px 15px;
      }
      h1 {
        font-size: 2rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Ievietot sludinājumu</h1>
    <form action="/api/ads" method="post">
      
      <h2>Galvenā informācija</h2>
      <label for="category">Kategorija</label>
      <select id="category" name="category" required>
        <option value="" disabled selected>Izvēlies kategoriju</option>
        <!-- Kategorijas tiks ģenerētas ar JS -->
      </select>

      <label for="subcategory1">Apakškategorija</label>
      <select id="subcategory1" name="subcategory1">
        <option value="" disabled selected>Vispirms izvēlies kategoriju</option>
      </select>

      <label for="subcategory2" style="display: none;">Dziļāka apakškategorija</label>
      <select id="subcategory2" name="subcategory2" style="display: none;">
        <option value="" disabled selected>Vispirms izvēlies apakškategoriju</option>
      </select>

      <label for="subcategory3" style="display: none;">Vēl dziļāka apakškategorija</label>
      <select id="subcategory3" name="subcategory3" style="display: none;">
        <option value="" disabled selected>Vispirms izvēlies dziļāku apakškategoriju</option>
      </select>
      
      <!-- Transporta filtri (esošie) -->
      <div id="transport-filters" class="filter-group">
        <h2>Transportlīdzekļa parametri</h2>
        <label for="car-brand">Marka</label>
        <select id="car-brand" name="car_brand"></select>

        <label for="car-model">Modelis</label>
        <select id="car-model" name="car_model"></select>
        
        <label>Gads</label>
        <div class="year-inputs">
            <div>
                <label for="car-year-from">No</label>
                <input type="number" id="car-year-from" name="car_year_from" placeholder="Piem., 1998" min="1900">
            </div>
            <div>
                <label for="car-year-to">Līdz</label>
                <input type="number" id="car-year-to" name="car_year_to" placeholder="Piem., 2024" min="1900">
            </div>
        </div>

        <label for="car-mileage">Nobraukums (km)</label>
        <input type="number" id="car-mileage" name="car_mileage" placeholder="Piem., 150000" min="0">

        <h2>Aprīkojums un ekstras</h2>
        <div class="extras-grid">
          <div class="extra-item">
            <input type="checkbox" id="extra-abs" name="car_extras" value="ABS">
            <label for="extra-abs">ABS</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-lietie-diski" name="car_extras" value="Lietie diski">
            <label for="extra-lietie-diski">Lietie diski</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-signalizācija" name="car_extras" value="Signalizācija">
            <label for="extra-signalizācija">Signalizācija</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-klimata-kontrole" name="car_extras" value="Klimata kontrole">
            <label for="extra-klimata-kontrole">Klimata kontrole</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-kondicionieris" name="car_extras" value="Kondicionieris">
            <label for="extra-kondicionieris">Kondicionieris</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-kruīza-kontrole" name="car_extras" value="Kruīza kontrole">
            <label for="extra-kruīza-kontrole">Kruīza kontrole</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-stūres-hidropastiprinātājs" name="car_extras" value="Stūres hidropastiprinātājs">
            <label for="extra-stūres-hidropastiprinātājs">Stūres hidropastiprinātājs</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-elektr-stūres-pastiprinātājs" name="car_extras" value="Elektr. stūres pastiprinātājs">
            <label for="extra-elektr-stūres-pastiprinātājs">Elektr. stūres pastiprinātājs</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-parkošanās-sens-aizmugurē" name="car_extras" value="Parkošanās sens. aizmugurē">
            <label for="extra-parkošanās-sens-aizmugurē">Parkošanās sens. aizmugurē</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-parkošanās-sens-priekšā" name="car_extras" value="Parkošanās sens. priekšā">
            <label for="extra-parkošanās-sens-priekšā">Parkošanās sens. priekšā</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-atpakaļskata-kamera" name="car_extras" value="Atpakaļskata kamera">
            <label for="extra-atpakaļskata-kamera">Atpakaļskata kamera</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-distances-kontrole" name="car_extras" value="Distances kontrole">
            <label for="extra-distances-kontrole">Distances kontrole</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-lietus-sensors" name="car_extras" value="Lietus sensors">
            <label for="extra-lietus-sensors">Lietus sensors</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-jumta-reliņi" name="car_extras" value="Jumta reliņi">
            <label for="extra-jumta-reliņi">Jumta reliņi</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-sakabes-āķis" name="car_extras" value="Sakabes āķis">
            <label for="extra-sakabes-āķis">Sakabes āķis</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-lūka" name="car_extras" value="Lūka">
            <label for="extra-lūka">Lūka</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-panorāmas-lūka" name="car_extras" value="Panorāmas lūka">
            <label for="extra-panorāmas-lūka">Panorāmas lūka</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-pilnpiedziņa-4x4" name="car_extras" value="Pilnpiedziņa 4x4">
            <label for="extra-pilnpiedziņa-4x4">Pilnpiedziņa 4x4</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-pneimopiekare" name="car_extras" value="Pneimopiekare">
            <label for="extra-pneimopiekare">Pneimopiekare</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-sporta-pakete" name="car_extras" value="Sporta pakete">
            <label for="extra-sporta-pakete">Sporta pakete</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-servisa-grāmatiņa" name="car_extras" value="Servisa grāmatiņa">
            <label for="extra-servisa-grāmatiņa">Servisa grāmatiņa</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-vieglmetāla-diski" name="car_extras" value="Vieglmetāla diski">
            <label for="extra-vieglmetāla-diski">Vieglmetāla diski</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-ādas-apdare" name="car_extras" value="Ādas apdare">
            <label for="extra-ādas-apdare">Ādas apdare</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-roku-balsti" name="car_extras" value="Roku balsti">
            <label for="extra-roku-balsti">Roku balsti</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-tonēti-aizmugurējie-logi" name="car_extras" value="Tonēti aizmugurējie logi">
            <label for="extra-tonēti-aizmugurējie-logi">Tonēti aizmugurējie logi</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-saulessargi-logos" name="car_extras" value="Saulessargi logos">
            <label for="extra-saulessargi-logos">Saulessargi logos</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-isofix-stiprinājumi" name="car_extras" value="Isofix stiprinājumi">
            <label for="extra-isofix-stiprinājumi">Isofix stiprinājumi</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-ledusskapis" name="car_extras" value="Ledusskapis">
            <label for="extra-ledusskapis">Ledusskapis</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-elektriski-regulējami-sēdekļi" name="car_extras" value="Elektriski regulējami sēdekļi">
            <label for="extra-elektriski-regulējami-sēdekļi">Elektriski regulējami sēdekļi</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-sēdekļi-ar-atmiņu" name="car_extras" value="Sēdekļi ar atmiņu">
            <label for="extra-sēdekļi-ar-atmiņu">Sēdekļi ar atmiņu</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-sēdekļu-apsilde" name="car_extras" value="Sēdekļu apsilde">
            <label for="extra-sēdekļu-apsilde">Sēdekļu apsilde</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-sporta-sēdekļi" name="car_extras" value="Sporta sēdekļi">
            <label for="extra-sporta-sēdekļi">Sporta sēdekļi</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-ventilējami-sēdekļi" name="car_extras" value="Ventilējami sēdekļi">
            <label for="extra-ventilējami-sēdekļi">Ventilējami sēdekļi</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-masāžas-sēdekļi" name="car_extras" value="Masāžas sēdekļi">
            <label for="extra-masāžas-sēdekļi">Masāžas sēdekļi</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-gaisa-spilveni-air-bag" name="car_extras" value="Gaisa spilveni (Air-bag)">
            <label for="extra-gaisa-spilveni-air-bag">Gaisa spilveni (Air-bag)</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-centrālā-atslēga" name="car_extras" value="Centrālā atslēga">
            <label for="extra-centrālā-atslēga">Centrālā atslēga</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-imobilaizers" name="car_extras" value="Imobilaizers">
            <label for="extra-imobilaizers">Imobilaizers</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-navigācija" name="car_extras" value="Navigācija">
            <label for="extra-navigācija">Navigācija</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-borta-dators" name="car_extras" value="Borta dators">
            <label for="extra-borta-dators">Borta dators</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-riepu-spiediena-kontrole" name="car_extras" value="Riepu spiediena kontrole">
            <label for="extra-riepu-spiediena-kontrole">Riepu spiediena kontrole</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-palīgsistēma-braukš-joslās" name="car_extras" value="Palīgsistēma braukš. joslās">
            <label for="extra-palīgsistēma-braukš-joslās">Palīgsistēma braukš. joslās</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-ceļa-zīmju-atpazīš-sistēma" name="car_extras" value="Ceļa zīmju atpazīš. sistēma">
            <label for="extra-ceļa-zīmju-atpazīš-sistēma">Ceļa zīmju atpazīš. sistēma</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-klusuma-zonu-sistēma" name="car_extras" value="Klusuma zonu sistēma">
            <label for="extra-klusuma-zonu-sistēma">Klusuma zonu sistēma</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-fm/am" name="car_extras" value="FM/AM">
            <label for="extra-fm/am">FM/AM</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-cd" name="car_extras" value="CD">
            <label for="extra-cd">CD</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-cd-mainītājs" name="car_extras" value="CD mainītājs">
            <label for="extra-cd-mainītājs">CD mainītājs</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-dvd" name="car_extras" value="DVD">
            <label for="extra-dvd">DVD</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-dvd-mainītājs" name="car_extras" value="DVD mainītājs">
            <label for="extra-dvd-mainītājs">DVD mainītājs</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-mp3" name="car_extras" value="MP3">
            <label for="extra-mp3">MP3</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-usb" name="car_extras" value="USB">
            <label for="extra-usb">USB</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-sdcard" name="car_extras" value="SDcard">
            <label for="extra-sdcard">SDcard</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-hdd" name="car_extras" value="HDD">
            <label for="extra-hdd">HDD</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-tv" name="car_extras" value="TV">
            <label for="extra-tv">TV</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-lcd" name="car_extras" value="LCD">
            <label for="extra-lcd">LCD</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-aux" name="car_extras" value="AUX">
            <label for="extra-aux">AUX</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-bluetooth" name="car_extras" value="Bluetooth">
            <label for="extra-bluetooth">Bluetooth</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-hands-free" name="car_extras" value="Hands-free">
            <label for="extra-hands-free">Hands-free</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-subwoofer" name="car_extras" value="Subwoofer">
            <label for="extra-subwoofer">Subwoofer</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-bi-ksenona" name="car_extras" value="Bi-ksenona">
            <label for="extra-bi-ksenona">Bi-ksenona</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-led" name="car_extras" value="LED">
            <label for="extra-led">LED</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-led-bremžugunis" name="car_extras" value="LED bremžugunis">
            <label for="extra-led-bremžugunis">LED bremžugunis</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-lampu-mazgātāji" name="car_extras" value="Lampu mazgātāji">
            <label for="extra-lampu-mazgātāji">Lampu mazgātāji</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-miglas-lukturi" name="car_extras" value="Miglas lukturi">
            <label for="extra-miglas-lukturi">Miglas lukturi</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-automāt-tuvās-gaismas" name="car_extras" value="Automāt. tuvās gaismas">
            <label for="extra-automāt-tuvās-gaismas">Automāt. tuvās gaismas</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-automāt-tālās-gaismas" name="car_extras" value="Automāt. tālās gaismas">
            <label for="extra-automāt-tālās-gaismas">Automāt. tālās gaismas</label>
          </div>
          <div class="extra-item">
            <input type="checkbox" id="extra-adaptīvās-tālās-gaismas" name="car_extras" value="Adaptīvās tālās gaismas">
            <label for="extra-adaptīvās-tālās-gaismas">Adaptīvās tālās gaismas</label>
          </div>
        </div>
      </div>

      <!-- Papildu filtru grupas -->
      <div id="general-filters" class="filter-group">
          <h2>Vispārīgie parametri</h2>
          <label for="item-condition">Stāvoklis</label>
          <select id="item-condition" name="item_condition">
              <option value="" disabled selected>Izvēlies stāvokli</option>
              <option value="jauns">Jauns</option>
              <option value="gandrīz-jauns">Gandrīz jauns</option>
              <option value="lietots-labs">Lietots (labs stāvoklis)</option>
              <option value="lietots-viduvējs">Lietots (viduvējs stāvoklis)</option>
              <option value="bojats">Bojāts (rezerves daļām)</option>
          </select>
          
          <label for="item-brand">Zīmols/Ražotājs</label>
          <input type="text" id="item-brand" name="item_brand" placeholder="Piem., Bosch, Nike, iPhone">

          <label for="item-material">Materiāls</label>
          <input type="text" id="item-material" name="item_material" placeholder="Piem., koks, kokvilna, stikls">
      </div>

      <div id="electronics-filters" class="filter-group">
        <h2>Elektronikas parametri</h2>
        <label for="electronics-brand">Zīmols</label>
        <input type="text" id="electronics-brand" name="electronics_brand" placeholder="Piem., Samsung, Apple">

        <label for="electronics-model">Modelis</label>
        <input type="text" id="electronics-model" name="electronics_model" placeholder="Piem., iPhone 15 Pro, Galaxy S24">

        <label for="electronics-storage">Atmiņa (GB)</label>
        <input type="number" id="electronics-storage" name="electronics_storage" placeholder="Piem., 128, 256">
        
        <label for="electronics-screen-size">Ekrāna izmērs (collas)</label>
        <input type="number" id="electronics-screen-size" name="electronics_screen_size" placeholder="Piem., 6.1, 15.6">

        <label for="electronics-condition">Stāvoklis</label>
        <select id="electronics-condition" name="electronics_condition">
            <option value="" disabled selected>Izvēlies stāvokli</option>
            <option value="jauns">Jauns</option>
            <option value="gandrīz-jauns">Gandrīz jauns</option>
            <option value="lietots-labs">Lietots (labs stāvoklis)</option>
            <option value="lietots-viduvējs">Lietots (viduvējs stāvoklis)</option>
            <option value="bojats">Bojāts (rezerves daļām)</option>
        </select>
      </div>
      
      <div id="clothing-filters" class="filter-group">
        <h2>Apģērba parametri</h2>
        <label for="clothing-size">Izmērs</label>
        <input type="text" id="clothing-size" name="clothing_size" placeholder="Piem., M, L, 38, 42">

        <label for="clothing-gender">Dzimums</label>
        <select id="clothing-gender" name="clothing_gender">
            <option value="" disabled selected>Izvēlies dzimumu</option>
            <option value="sieviesu">Sievietēm</option>
            <option value="viriesu">Vīriešiem</option>
            <option value="bernu">Bērniem</option>
            <option value="unisex">Unisex</option>
        </select>

        <label for="clothing-material">Materiāls</label>
        <input type="text" id="clothing-material" name="clothing_material" placeholder="Piem., kokvilna, džinss, vilna">

        <label for="clothing-season">Sezona</label>
        <select id="clothing-season" name="clothing_season">
            <option value="" disabled selected>Izvēlies sezonu</option>
            <option value="vasara">Vasara</option>
            <option value="rudens">Rudens</option>
            <option value="ziema">Ziema</option>
            <option value="pavasaris">Pavasaris</option>
            <option value="universala">Universāla</option>
        </select>

        <label for="clothing-condition">Stāvoklis</label>
        <select id="clothing-condition" name="clothing_condition">
            <option value="" disabled selected>Izvēlies stāvokli</option>
            <option value="jauns">Jauns</option>
            <option value="gandrīz-jauns">Gandrīz jauns</option>
            <option value="lietots-labs">Lietots (labs stāvoklis)</option>
            <option value="lietots-viduvējs">Lietots (viduvējs stāvoklis)</option>
            <option value="bojats">Bojāts (rezerves daļām)</option>
        </select>
      </div>

      <div id="furniture-filters" class="filter-group">
        <h2>Mēbeļu parametri</h2>
        <label for="furniture-material">Materiāls</label>
        <input type="text" id="furniture-material" name="furniture_material" placeholder="Piem., koks, metāls, audums">

        <label for="furniture-color">Krāsa</label>
        <input type="text" id="furniture-color" name="furniture_color" placeholder="Piem., balta, brūna, pelēka">
        
        <label for="furniture-style">Stils</label>
        <input type="text" id="furniture-style" name="furniture_style" placeholder="Piem., moderns, klasisks, retro">

        <label for="furniture-dimensions">Izmēri (PxGxDz cm)</label>
        <input type="text" id="furniture-dimensions" name="furniture_dimensions" placeholder="Piem., 200x90x80">

        <label for="furniture-condition">Stāvoklis</label>
        <select id="furniture-condition" name="furniture_condition">
            <option value="" disabled selected>Izvēlies stāvokli</option>
            <option value="jauns">Jauns</option>
            <option value="gandrīz-jauns">Gandrīz jauns</option>
            <option value="lietots-labs">Lietots (labs stāvoklis)</option>
            <option value="lietots-viduvējs">Lietots (viduvējs stāvoklis)</option>
            <option value="bojats">Bojāts (rezerves daļām)</option>
        </select>
      </div>

      <div id="home-appliances-filters" class="filter-group">
        <h2>Sadzīves tehnikas parametri</h2>
        <label for="appliance-brand">Zīmols</label>
        <input type="text" id="appliance-brand" name="appliance_brand" placeholder="Piem., Bosch, Electrolux">

        <label for="appliance-model">Modelis</label>
        <input type="text" id="appliance-model" name="appliance_model" placeholder="Piem., WAU28T64GB, EW7F384SC">

        <label for="appliance-energy-class">Energoefektivitātes klase</label>
        <select id="appliance-energy-class" name="appliance_energy_class">
            <option value="" disabled selected>Izvēlies klasi</option>
            <option value="A+++">A+++</option>
            <option value="A++">A++</option>
            <option value="A+">A+</option>
            <option value="A">A</option>
            <option value="B">B</option>
            <option value="C">C</option>
            <option value="D">D</option>
        </select>

        <label for="appliance-capacity">Ietilpība/Tilpums</label>
        <input type="text" id="appliance-capacity" name="appliance_capacity" placeholder="Piem., 7 kg (veļas mašīnai), 250L (ledusskapim)">

        <label for="appliance-condition">Stāvoklis</label>
        <select id="appliance-condition" name="appliance_condition">
            <option value="" disabled selected>Izvēlies stāvokli</option>
            <option value="jauns">Jauns</option>
            <option value="gandrīz-jauns">Gandrīz jauns</option>
            <option value="lietots-labs">Lietots (labs stāvoklis)</option>
            <option value="lietots-viduvējs">Lietots (viduvējs stāvoklis)</option>
            <option value="bojats">Bojāts (rezerves daļām)</option>
        </select>
      </div>

      <div id="tools-equipment-filters" class="filter-group">
        <h2>Instrumentu un tehnikas parametri</h2>
        <label for="tool-type">Tips</label>
        <input type="text" id="tool-type" name="tool_type" placeholder="Piem., Urbjmašīna, Kompresors">

        <label for="tool-brand">Zīmols</label>
        <input type="text" id="tool-brand" name="tool_brand" placeholder="Piem., Makita, Stihl">

        <label for="tool-power">Jauda/Spriegums</label>
        <input type="text" id="tool-power" name="tool_power" placeholder="Piem., 18V, 2.2kW">

        <label for="tool-condition">Stāvoklis</label>
        <select id="tool-condition" name="tool_condition">
            <option value="" disabled selected>Izvēlies stāvokli</option>
            <option value="jauns">Jauns</option>
            <option value="gandrīz-jauns">Gandrīz jauns</option>
            <option value="lietots-labs">Lietots (labs stāvoklis)</option>
            <option value="lietots-viduvējs">Lietots (viduvējs stāvoklis)</option>
            <option value="bojats">Bojāts (rezerves daļām)</option>
        </select>
      </div>

      <div id="baby-items-filters" class="filter-group">
        <h2>Bērnu preču parametri</h2>
        <label for="baby-age">Vecums (gadi)</label>
        <input type="text" id="baby-age" name="baby_age" placeholder="Piem., 0-3, 3-6">

        <label for="baby-weight">Svars (kg)</label>
        <input type="number" id="baby-weight" name="baby_weight" placeholder="Piem., 0-13, 9-18">

        <label for="baby-brand">Zīmols</label>
        <input type="text" id="baby-brand" name="baby_brand" placeholder="Piem., Chicco, Cybex">

        <label for="baby-condition">Stāvoklis</label>
        <select id="baby-condition" name="baby_condition">
            <option value="" disabled selected>Izvēlies stāvokli</option>
            <option value="jauns">Jauns</option>
            <option value="gandrīz-jauns">Gandrīz jauns</option>
            <option value="lietots-labs">Lietots (labs stāvoklis)</option>
            <option value="lietots-viduvējs">Lietots (viduvējs stāvoklis)</option>
            <option value="bojats">Bojāts (rezerves daļām)</option>
        </select>
      </div>

      <div id="sports-leisure-filters" class="filter-group">
        <h2>Sporta un brīvā laika parametri</h2>
        <label for="sport-type">Sporta veids</label>
        <input type="text" id="sport-type" name="sport_type" placeholder="Piem., futbols, riteņbraukšana, fitness">

        <label for="sport-brand">Zīmols</label>
        <input type="text" id="sport-brand" name="sport_brand" placeholder="Piem., Nike, Adidas, Salomon">

        <label for="sport-size">Izmērs</label>
        <input type="text" id="sport-size" name="sport_size" placeholder="Piem., L, 43, 20 collas">

        <label for="sport-condition">Stāvoklis</label>
        <select id="sport-condition" name="sport_condition">
            <option value="" disabled selected>Izvēlies stāvokli</option>
            <option value="jauns">Jauns</option>
            <option value="gandrīz-jauns">Gandrīz jauns</option>
            <option value="lietots-labs">Lietots (labs stāvoklis)</option>
            <option value="lietots-viduvējs">Lietots (viduvējs stāvoklis)</option>
            <option value="bojats">Bojāts (rezerves daļām)</option>
        </select>
      </div>

      <div id="animals-filters" class="filter-group">
        <h2>Dzīvnieku preču parametri</h2>
        <label for="animal-type">Dzīvnieka veids</label>
        <input type="text" id="animal-type" name="animal_type" placeholder="Piem., suns, kaķis, zivtiņa">

        <label for="animal-breed">Šķirne (suņiem, kaķiem)</label>
        <input type="text" id="animal-breed" name="animal_breed" placeholder="Piem., Labradors, Siāmietis">

        <label for="animal-size">Izmērs (produktam)</label>
        <input type="text" id="animal-size" name="animal_size" placeholder="Piem., S, M, L (apģērbs, gultas)">

        <label for="animal-condition">Stāvoklis</label>
        <select id="animal-condition" name="animal_condition">
            <option value="" disabled selected>Izvēlies stāvokli</option>
            <option value="jauns">Jauns</option>
            <option value="gandrīz-jauns">Gandrīz jauns</option>
            <option value="lietots-labs">Lietots (labs stāvoklis)</option>
            <option value="lietots-viduvējs">Lietots (viduvējs stāvoklis)</option>
            <option value="bojats">Bojāts (rezerves daļām)</option>
        </select>
      </div>

      <div id="services-filters" class="filter-group">
        <h2>Pakalpojuma parametri</h2>
        <label for="service-type">Pakalpojuma veids</label>
        <input type="text" id="service-type" name="service_type" placeholder="Piem., Auto remonts, Frizieris">

        <label for="service-location">Atrašanās vieta</label>
        <input type="text" id="service-location" name="service_location" placeholder="Piem., Rīga, Centrs">

        <label for="service-availability">Pieejamība</label>
        <input type="text" id="service-availability" name="service_availability" placeholder="Piem., darba dienās, vakaros, pēc vienošanās">
      </div>

      <h2>Sludinājuma apraksts</h2>
      <label for="title">Nosaukums</label>
      <input type="text" id="title" name="title" placeholder="Piem., Pārdodu mazlietotu dīvānu, teicamā stāvoklī" required />

      <label for="description">Apraksts</label>
      <textarea id="description" name="description" placeholder="Šeit detalizēti aprakstiet preci..." required></textarea>
      
      <label for="price">Cena (EUR)</label>
      <input type="number" id="price" name="price" placeholder="0.00" min="0" step="0.01" />

      <label for="image">Attēla URL</label>
      <input type="text" id="image" name="image" placeholder="https://piemers.lv/attels.jpg" />

      <input type="submit" value="Iesniegt sludinājumu" />
    </form>
  </div>

  <script>
    // --- DATU IELĀDE UN FILTRU LOĢIKA ---
    
    // Elementu definēšana
    const categorySelect = document.getElementById('category');
    const subcategorySelect1 = document.getElementById('subcategory1');
    const subcategorySelect2 = document.getElementById('subcategory2');
    const subcategorySelect3 = document.getElementById('subcategory3');

    // Labels for subcategories
    const subcategoryLabel1 = document.querySelector('label[for="subcategory1"]');
    const subcategoryLabel2 = document.querySelector('label[for="subcategory2"]');
    const subcategoryLabel3 = document.querySelector('label[for="subcategory3"]');

    const transportFilters = document.getElementById('transport-filters');
    const carBrandSelect = document.getElementById('car-brand');
    const carModelSelect = document.getElementById('car-model');

    // Jaunās filtru grupas
    const generalFilters = document.getElementById('general-filters');
    const electronicsFilters = document.getElementById('electronics-filters');
    const clothingFilters = document.getElementById('clothing-filters');
    const furnitureFilters = document.getElementById('furniture-filters');
    const homeAppliancesFilters = document.getElementById('home-appliances-filters');
    const toolsEquipmentFilters = document.getElementById('tools-equipment-filters');
    const babyItemsFilters = document.getElementById('baby-items-filters');
    const sportsLeisureFilters = document.getElementById('sports-leisure-filters');
    const animalsFilters = document.getElementById('animals-filters');
    const servicesFilters = document.getElementById('services-filters');

    let carBrandAndModelData = {}; // Saglabā auto datus

    // Funkcija, kas aizpilda <select> laukus
    function populateSelect(selectElement, items, defaultOptionText) {
        selectElement.innerHTML = `<option value="" disabled selected>${defaultOptionText}</option>`;
        if (!items || items.length === 0) {
            selectElement.style.display = 'none';
            const label = document.querySelector(`label[for="${selectElement.id}"]`);
            if (label) label.style.display = 'none';
            return;
        }
        selectElement.style.display = 'block';
        const label = document.querySelector(`label[for="${selectElement.id}"]`);
        if (label) label.style.display = 'block';

        items.forEach(item => {
            const option = document.createElement('option');
            option.value = item.id; // Tagad vērtība ir ID no datubāzes
            option.textContent = item.name;
            // Store filterGroup as a data attribute for later retrieval
            if (item.filterGroup) {
                option.dataset.filterGroup = item.filterGroup;
            }
            selectElement.appendChild(option);
        });
    }

    // Funkcija, kas paslēpj visas specifisko filtru grupas
    function hideAllFilterGroups() {
        const filterGroups = document.querySelectorAll('.filter-group');
        filterGroups.forEach(group => group.style.display = 'none');
    }

    // Funkcija, kas parāda attiecīgo filtru grupu
    function showFilterGroup(groupId) {
        hideAllFilterGroups();
        const targetGroup = document.getElementById(groupId);
        if (targetGroup) {
            targetGroup.style.display = 'block';
        }
    }

    // Funkcija, kas ielādē apakškategorijas no servera
    async function fetchCategories(parentId = null) {
        try {
            const url = parentId ? `/api/categories/${parentId}/subcategories` : '/api/categories';
            const response = await fetch(url);
            if (!response.ok) {
                throw new Error('Network response was not ok.');
            }
            const data = await response.json();
            return data;
        } catch (error) {
            console.error('Error fetching categories:', error);
            return [];
        }
    }

    // Funkcija, kas atjauno apakškategoriju laukus un parāda filtrus
    async function updateSubcategories(level, selectedId) {
        let currentSelect;
        let nextSelect;
        let nextLabel;
        let items = [];

        // Reset lower level selects and labels
        for (let i = level + 1; i <= 3; i++) {
            const select = document.getElementById(`subcategory${i}`);
            const label = document.querySelector(`label[for="subcategory${i}"]`);
            select.innerHTML = `<option value="" disabled selected>Vispirms izvēlies ${i === 2 ? 'apakškategoriju' : 'dziļāku apakškategoriju'}</option>`;
            select.style.display = 'none';
            if (label) label.style.display = 'none';
        }
        hideAllFilterGroups(); // Hide all filters when category changes

        if (level === 0) { // Main category change
            currentSelect = categorySelect;
            nextSelect = subcategorySelect1;
            nextLabel = subcategoryLabel1;
            items = await fetchCategories(selectedId);
        } else if (level === 1) { // Subcategory 1 change
            currentSelect = subcategorySelect1;
            nextSelect = subcategorySelect2;
            nextLabel = subcategoryLabel2;
            items = await fetchCategories(selectedId);
        } else if (level === 2) { // Subcategory 2 change
            currentSelect = subcategorySelect2;
            nextSelect = subcategorySelect3;
            nextLabel = subcategoryLabel3;
            items = await fetchCategories(selectedId);
        } else { // Deepest level reached, determine filter group
            const selectedOption = currentSelect.querySelector(`option[value="${selectedId}"]`);
            const filterGroup = selectedOption ? selectedOption.dataset.filterGroup : null;
            
            if (filterGroup) {
                showFilterGroup(filterGroup);
                // Handle specific logic for "Vieglie auto"
                if (filterGroup === 'transport-filters' && selectedOption.textContent === 'Vieglie auto') {
                    if (Object.keys(carBrandAndModelData).length > 0) {
                        const carBrands = Object.keys(carBrandAndModelData);
                        populateSelect(carBrandSelect, carBrands.map(name => ({id: name, name: name})), "Izvēlies marku...");
                    } else {
                        carBrandSelect.innerHTML = '<option>Dati nav pieejami</option>';
                    }
                    carModelSelect.innerHTML = '<option value="" disabled selected>Vispirms izvēlies marku</option>';
                }
            } else {
                showFilterGroup('general-filters'); // Default
            }
            return;
        }

        if (items.length > 0) {
            populateSelect(nextSelect, items, `Izvēlies ${level === 0 ? 'apakškategoriju' : 'dziļāku apakškategoriju'}...`);
        } else {
            // If no subcategories, this level is the leaf node. Check for filterGroup.
            const selectedOption = currentSelect.querySelector(`option[value="${selectedId}"]`);
            const filterGroup = selectedOption ? selectedOption.dataset.filterGroup : null;
            
            if (filterGroup) {
                showFilterGroup(filterGroup);
                if (filterGroup === 'transport-filters' && selectedOption.textContent === 'Vieglie auto') {
                     if (Object.keys(carBrandAndModelData).length > 0) {
                        const carBrands = Object.keys(carBrandAndModelData);
                        populateSelect(carBrandSelect, carBrands.map(name => ({id: name, name: name})), "Izvēlies marku...");
                    } else {
                        carBrandSelect.innerHTML = '<option>Dati nav pieejami</option>';
                    }
                    carModelSelect.innerHTML = '<option value="" disabled selected>Vispirms izvēlies marku</option>';
                }
            } else {
                showFilterGroup('general-filters');
            }
        }
    }


    // Galvenā loģika, kas sākas, kad lapa ir ielādējusies
    document.addEventListener('DOMContentLoaded', async () => {
        // Ielādējam sagatavotos auto datus no servera static mapes
        try {
            const carDataResponse = await fetch('/static/car_data.json');
            if (!carDataResponse.ok) throw new Error('Network response was not ok for car data');
            carBrandAndModelData = await carDataResponse.json();
            console.log("Auto marku un modeļu dati veiksmīgi ielādēti.");
        } catch (error) {
            console.error('Error loading car data:', error);
            carBrandSelect.innerHTML = '<option>Error: Could not load car brand list.</option>';
        }

        // Ielādējam galvenās kategorijas no servera
        try {
            const mainCategories = await fetchCategories(); // No parentId means fetch top-level
            populateSelect(categorySelect, mainCategories, "Izvēlies kategoriju...");
        } catch (error) {
            console.error('Error loading main categories:', error);
            categorySelect.innerHTML = '<option>Error: Could not load categories.</option>';
        }

        initializeFilters(); // Iestatām notikumu klausītājus
    });

    // Funkcija, kas iestata visus notikumu klausītājus (event listeners)
    function initializeFilters() {
        hideAllFilterGroups(); // Sākumā paslēpj visus filtrus

        categorySelect.addEventListener('change', () => updateSubcategories(0, categorySelect.value));
        subcategorySelect1.addEventListener('change', () => updateSubcategories(1, subcategorySelect1.value));
        subcategorySelect2.addEventListener('change', () => updateSubcategories(2, subcategorySelect2.value));
        subcategorySelect3.addEventListener('change', () => updateSubcategories(3, subcategorySelect3.value));

        carBrandSelect.addEventListener('change', () => {
            const selectedBrand = carBrandSelect.value;
            const models = carBrandAndModelData[selectedBrand] || [];
            populateSelect(carModelSelect, models.map(name => ({id: name, name: name})), "Izvēlies modeli...");
        });
    }

    // Forma iesniegšanas loģika
    document.querySelector('form').addEventListener('submit', async (event) => {
        event.preventDefault();
        const formData = new FormData(event.target);
        const data = {};

        // Collect all form data, including dynamically shown fields
        for (let [key, value] of formData.entries()) {
            // Handle multiple checkboxes for car_extras
            if (key === 'car_extras') {
                if (!data[key]) {
                    data[key] = [];
                }
                data[key].push(value);
            } else {
                data[key] = value;
            }
        }

        // Determine the final category_id
        let finalCategoryId = null;
        if (subcategorySelect3.value) {
            finalCategoryId = subcategorySelect3.value;
        } else if (subcategorySelect2.value) {
            finalCategoryId = subcategorySelect2.value;
        } else if (subcategorySelect1.value) {
            finalCategoryId = subcategorySelect1.value;
        } else if (categorySelect.value) {
            finalCategoryId = categorySelect.value;
        }
        data.category_id = finalCategoryId; // Pievienojam datu bāzes ID

        try {
            const response = await fetch('/api/ads', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            });
            const result = await response.json();
            if (response.ok) {
                alert(result.message);
                event.target.reset(); // Notīra formu
                // Reset category selects and hide filters
                categorySelect.selectedIndex = 0;
                updateSubcategories(0, '');
            } else {
                alert(`Kļūda: ${result.error}`);
            }
        } catch (error) {
            console.error('Kļūda, sūtot sludinājumu:', error);
            alert('Neizdevās iesniegt sludinājumu. Lūdzu, mēģiniet vēlreiz.');
        }
    });

  </script>
</body>
</html>
